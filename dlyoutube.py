"""
================================================================================
    โปรแกรมดาวน์โหลดวิดีโอจากยูทูป (YouTube Video Downloader)
================================================================================

วัตถุประสงค์ (Purpose):
    - ดาวน์โหลดวิดีโอจากเว็บไซต์ YouTube ลงมาเก็บไว้บนเครื่องคอมพิวเตอร์
    - ใช้ไลบรารี yt-dlp ซึ่งเป็นเครื่องมือจัดการการดาวน์โหลด
    
ความต้องการ (Requirements):
    - ต้องติดตั้ง yt-dlp: pip install yt-dlp
    - เชื่อมต่ออินเทอร์เน็ต

การทำงาน (How it works):
    1. รับ URL ของวิดีโอ YouTube จากผู้ใช้
    2. สร้างการตั้งค่าสำหรับการดาวน์โหลด
    3. ดาวน์โหลดวิดีโอในรูปแบบที่ดีที่สุด
    4. บันทึกไฟล์ด้วยชื่อของวิดีโอต้นฉบับ

================================================================================
"""

# นำเข้าไลบรารี yt-dlp สำหรับดาวน์โหลดวิดีโอ YouTube
import yt_dlp


def download_youtube(url):
    """
    ฟังก์ชันดาวน์โหลดวิดีโอจาก YouTube
    
    รายละเอียด (Description):
        - ฟังก์ชันนี้รับ URL ของวิดีโอ YouTube
        - ดาวน์โหลดวิดีโอในคุณภาพที่ดีที่สุด
        - บันทึกไฟล์ในโฟลเดอร์ปัจจุบัน
    
    พารามิเตอร์ (Parameters):
        url (string): ลิงก์เต็มของวิดีโอ YouTube
                      เช่น https://www.youtube.com/watch?v=dQw4w9WgXcQ
    
    ค่าที่คืนกลับ (Return):
        ไม่มี (None) - เพียงแค่สร้างไฟล์วิดีโอลงในเครื่อง
    
    ตัวอย่างการใช้ (Example):
        download_youtube("https://www.youtube.com/watch?v=dQw4w9WgXcQ")
    """
    
    # ====== ส่วนที่ 1: สร้างการตั้งค่า (Configuration) ======
    # สร้าง dictionary ที่เก็บตัวเลือกต่างๆ สำหรับการดาวน์โหลด
    ydl_opts = {
        # 'format': ตั้งคุณภาพของวิดีโอที่จะดาวน์โหลด
        # 'best' = เลือกคุณภาพดีที่สุดที่มี
        'format': 'best',
        
        # 'outtmpl': กำหนดรูปแบบของชื่อไฟล์ที่บันทึก
        # %(title)s = ชื่อของวิดีโอต้นฉบับ
        # %(ext)s = นามสกุลไฟล์ (เช่น mp4, webm)
        'outtmpl': '%(title)s.%(ext)s'
    }

    # ====== ส่วนที่ 2: ดาวน์โหลดวิดีโอ (Download) ======
    # สร้าง object ของ YoutubeDL เพื่อจัดการการดาวน์โหลด
    # with statement: ใช้สำหรับ context management
    #   - เปิด: สร้าง object
    #   - ปิด: ล้าง resources อย่างอัตโนมัติ
    #   - ป้องกัน: ป้องกันการรั่วไหลของหน่วยความจำ
    with yt_dlp.YoutubeDL(ydl_opts) as ydl:
        # ดาวน์โหลดวิดีโอจาก URL ที่ส่งเข้ามา
        # [url] = ใส่ URL ในรูปแบบ list (เพราะบางครั้งอาจมีหลาย URL)
        ydl.download([url])


# ====== ส่วนที่ 3: โปรแกรมหลัก (Main Program) ======
if __name__ == "__main__":
    """
    ตรงนี้เป็นจุดเริ่มต้นของโปรแกรม (Entry point)
    
    if __name__ == "__main__": ความหมาย:
        - เพียงแค่รันไฟล์นี้โดยตรง (ไม่ได้ import มาจากไฟล์อื่น)
        - ป้องกันไม่ให้โปรแกรมรันเมื่อไฟล์นี้ถูก import
    
    ขั้นตอนการทำงาน:
        1. แสดงข้อความยินดีต้อนรับ
        2. ขอให้ผู้ใช้ป้อน URL
        3. เรียกฟังก์ชัน download_youtube()
        4. แสดงข้อความการเสร็จสิ้น
    """
    
    # แสดงชื่อโปรแกรม
    print("=== YouTube Downloader ===")
    
    # ขอให้ผู้ใช้ป้อนข้อมูล: URL ของวิดีโอ YouTube
    # input() = ดึงข้อมูลจากคีย์บอร์ด
    # "กรุณาใส่ URL ของ YouTube: " = ข้อความแสดงบอกผู้ใช้
    video_url = input("กรุณาใส่ URL ของ YouTube: ")
    
    # เรียกใช้ฟังก์ชัน download_youtube() ส่ง video_url เข้าไป
    download_youtube(video_url)
    
    # แสดงข้อความเมื่อเสร็จสิ้นการดาวน์โหลด
    print("ดาวน์โหลดเสร็จสิ้น")
